<section id="portfolio" #portfolioSection class="relative">
  <div class="container mx-auto px-4">
    <!-- Section Header -->
    <div class="text-center mb-10 sm:mb-12 md:mb-16">
      <h2 class="section-title animate-on-scroll">
        <span class="text-gradient">作品集</span>
      </h2>
      <p class="section-subtitle animate-on-scroll">Featured Projects</p>
    </div>

    <!-- Projects Grid - 改善響應式 -->
    <div
      class="projects-grid grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-5 md:gap-6 lg:gap-8 max-w-5xl mx-auto"
    >
      @for (project of projects; track project.id) {
      <div
        class="project-card glass-card rounded-xl sm:rounded-2xl overflow-hidden border transition-all duration-500 cursor-pointer group"
        [class]="getBorderClass(project.color)"
        (click)="openProject(project)"
      >
        <!-- Project Image / Placeholder -->
        <div
          class="relative h-36 sm:h-40 md:h-48 overflow-hidden bg-gradient-to-br"
          [class]="getGradientClass(project.color)"
        >
          <!-- Decorative Elements -->
          <div class="absolute inset-0 flex items-center justify-center">
            <span class="text-4xl sm:text-5xl md:text-6xl font-bold text-white/10 font-display">{{
              project.name.charAt(0)
            }}</span>
          </div>

          <!-- Hover/Touch Overlay -->
          <div
            class="absolute inset-0 bg-gradient-to-t from-deep-space/90 to-transparent opacity-0 group-hover:opacity-100 group-active:opacity-100 transition-opacity duration-300 flex items-end p-4 sm:p-5 md:p-6"
          >
            <span class="text-neon-cyan font-medium flex items-center gap-2 text-sm sm:text-base">
              查看詳情
              <svg
                class="w-4 h-4 sm:w-5 sm:h-5 transform group-hover:translate-x-1 transition-transform flex-shrink-0"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 8l4 4m0 0l-4 4m4-4H3"
                />
              </svg>
            </span>
          </div>

          <!-- Floating Badge -->
          <div class="absolute top-3 right-3 sm:top-4 sm:right-4">
            <span
              class="px-2 py-0.5 sm:px-3 sm:py-1 rounded-full text-[10px] sm:text-xs font-medium glass-card"
              [class.text-neon-cyan]="project.color === 'cyan'"
              [class.text-neon-pink]="project.color === 'pink'"
              [class.text-purple-400]="project.color === 'purple'"
            >
              {{ project.technologies[0] }}
            </span>
          </div>
        </div>

        <!-- Project Info -->
        <div class="p-4 sm:p-5 md:p-6">
          <h3
            class="text-base sm:text-lg md:text-xl font-bold text-white mb-1.5 sm:mb-2 group-hover:text-gradient transition-all"
          >
            {{ project.name }}
          </h3>
          <p class="text-gray-400 text-xs sm:text-sm mb-3 sm:mb-4 line-clamp-2">
            {{ project.description }}
          </p>

          <!-- Tech Tags -->
          <div class="flex flex-wrap gap-1.5 sm:gap-2">
            @for (tech of project.technologies.slice(0, 3); track tech) {
            <span
              class="px-1.5 py-0.5 sm:px-2 sm:py-1 text-[10px] sm:text-xs rounded bg-deep-space/50 text-gray-400 border border-gray-700"
            >
              {{ tech }}
            </span>
            } @if (project.technologies.length > 3) {
            <span
              class="px-1.5 py-0.5 sm:px-2 sm:py-1 text-[10px] sm:text-xs rounded bg-deep-space/50 text-gray-500"
            >
              +{{ project.technologies.length - 3 }}
            </span>
            }
          </div>
        </div>
      </div>
      }
    </div>
  </div>

  <!-- Project Modal - 改善移動端 -->
  @if (selectedProject()) {
  <div
    class="fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-deep-space/80 backdrop-blur-sm animate-fade-in"
    (click)="closeModal()"
  >
    <div
      class="relative w-full sm:w-auto sm:max-w-2xl max-h-[85vh] sm:max-h-[90vh] overflow-y-auto glass-card rounded-t-2xl sm:rounded-2xl animate-scale-in sm:m-4"
      (click)="$event.stopPropagation()"
    >
      <!-- Mobile drag indicator -->
      <div class="sm:hidden flex justify-center pt-3 pb-1">
        <div class="w-10 h-1 bg-gray-600 rounded-full"></div>
      </div>

      <!-- Close Button -->
      <button
        class="absolute top-3 right-3 sm:top-4 sm:right-4 p-2 rounded-full glass-card text-gray-400 hover:text-white hover:bg-neon-cyan/20 transition-all z-10"
        (click)="closeModal()"
        aria-label="關閉"
      >
        <svg
          class="w-5 h-5 sm:w-6 sm:h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>

      <!-- Modal Header -->
      <div
        class="relative h-40 sm:h-48 md:h-56 bg-gradient-to-br"
        [class]="getGradientClass(selectedProject()!.color)"
      >
        <div class="absolute inset-0 flex items-center justify-center">
          <span class="text-6xl sm:text-7xl md:text-8xl font-bold text-white/10 font-display">{{
            selectedProject()!.name.charAt(0)
          }}</span>
        </div>
      </div>

      <!-- Modal Content -->
      <div class="p-5 sm:p-6 md:p-8">
        <h3 class="text-xl sm:text-2xl font-bold text-white mb-2">
          {{ selectedProject()!.name }}
        </h3>
        <p class="text-gray-400 text-sm sm:text-base mb-5 sm:mb-6">{{ selectedProject()!.description }}</p>

        <!-- Achievements -->
        <div class="mb-5 sm:mb-6">
          <h4
            class="text-base sm:text-lg font-semibold text-white mb-2 sm:mb-3 flex items-center gap-2"
          >
            <svg
              class="w-4 h-4 sm:w-5 sm:h-5 text-neon-cyan flex-shrink-0"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"
              />
            </svg>
            主要成就
          </h4>
          <ul class="space-y-1.5 sm:space-y-2">
            @for (achievement of selectedProject()!.achievements; track
            achievement) {
            <li class="flex items-start gap-2 sm:gap-3 text-gray-300 text-sm sm:text-base">
              <span class="text-neon-pink mt-0.5 sm:mt-1 flex-shrink-0">▸</span>
              <span>{{ achievement }}</span>
            </li>
            }
          </ul>
        </div>

        <!-- Technologies -->
        <div>
          <h4
            class="text-base sm:text-lg font-semibold text-white mb-2 sm:mb-3 flex items-center gap-2"
          >
            <svg
              class="w-4 h-4 sm:w-5 sm:h-5 text-neon-pink flex-shrink-0"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"
              />
            </svg>
            技術棧
          </h4>
          <div class="flex flex-wrap gap-1.5 sm:gap-2">
            @for (tech of selectedProject()!.technologies; track tech) {
            <span
              class="px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm rounded-lg bg-deep-purple/30 text-gray-300 border border-neon-cyan/20"
            >
              {{ tech }}
            </span>
            }
          </div>
        </div>
      </div>
    </div>
  </div>
  }

  <!-- Background Decoration -->
  <div
    class="absolute top-1/4 right-0 w-48 sm:w-64 md:w-80 h-48 sm:h-64 md:h-80 bg-neon-cyan/5 rounded-full blur-3xl pointer-events-none"
  ></div>
  <div
    class="absolute bottom-1/4 left-0 w-56 sm:w-72 md:w-96 h-56 sm:h-72 md:h-96 bg-neon-pink/5 rounded-full blur-3xl pointer-events-none"
  ></div>
</section>
