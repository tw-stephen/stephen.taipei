<!--
  工作經歷區塊
  - 使用時間軸展示工作經歷
  - 支援展開/收起詳細內容
  - 響應式設計：移動端單列，桌面端交錯佈局
-->
<section id="experience" #experienceSection class="relative">
  <div class="container mx-auto px-4">
    <!-- Section Header -->
    <div class="text-center mb-10 sm:mb-12 md:mb-16">
      <h2 class="section-title animate-on-scroll">
        <span class="text-gradient">工作經歷</span>
      </h2>
      <p class="section-subtitle animate-on-scroll">Work Experience</p>
    </div>

    <!-- Timeline Container -->
    <div class="timeline max-w-4xl mx-auto relative">
      <!-- Timeline Line - 移動端靠左，桌面端置中 -->
      <div class="absolute left-3 sm:left-4 lg:left-1/2 top-0 bottom-0 w-0.5 bg-gradient-to-b from-neon-cyan via-neon-pink to-deep-purple lg:-translate-x-px"></div>

      @for (exp of experiences; track exp.id; let i = $index; let odd = $odd) {
        <!-- Timeline Item - 使用 CSS 控制交錯佈局 -->
        <div
          class="timeline-item relative mb-8 sm:mb-10 lg:mb-16"
          [attr.data-position]="odd ? 'right' : 'left'"
        >
          <!-- Timeline Dot - 響應式尺寸 -->
          <div
            class="absolute left-3 sm:left-4 lg:left-1/2 w-3 h-3 sm:w-4 sm:h-4 rounded-full -translate-x-1/2 z-10"
            [class.bg-neon-cyan]="exp.current"
            [class.bg-neon-pink]="!exp.current"
            [class.animate-pulse]="exp.current"
          >
            <div class="absolute inset-0 rounded-full animate-ping opacity-30"
              [class.bg-neon-cyan]="exp.current"
              [class.bg-neon-pink]="!exp.current"
            ></div>
          </div>

          <!-- Content Card - 佈局由 CSS 控制 -->
          <div
            class="ml-8 sm:ml-12 lg:ml-0 glass-card rounded-xl p-4 sm:p-5 md:p-6 hover-glow cursor-pointer transition-all duration-300"
            (click)="toggleExpand(exp.id)"
          >
            <!-- Header -->
            <div class="flex flex-col sm:flex-row sm:items-center gap-2 mb-3 sm:mb-4">
              <!-- Period Badge -->
              <span class="inline-flex items-center gap-1.5 px-2.5 py-1 sm:px-3 rounded-full text-[10px] sm:text-xs font-medium w-fit"
                [class.bg-neon-cyan/20]="exp.current"
                [class.text-neon-cyan]="exp.current"
                [class.bg-neon-pink/20]="!exp.current"
                [class.text-neon-pink]="!exp.current"
              >
                @if (exp.current) {
                  <span class="w-1.5 h-1.5 sm:w-2 sm:h-2 bg-neon-cyan rounded-full animate-pulse"></span>
                }
                {{ exp.period }}
              </span>
            </div>

            <!-- Company & Position -->
            <h3 class="text-base sm:text-lg md:text-xl font-bold text-white mb-1">{{ exp.company }}</h3>
            <p class="text-neon-cyan font-medium text-sm sm:text-base mb-2 sm:mb-3">{{ exp.position }}</p>

            <!-- Description -->
            <p class="text-gray-400 text-sm sm:text-base mb-3 sm:mb-4 leading-relaxed">{{ exp.description }}</p>

            <!-- Expandable Content -->
            @if (isExpanded(exp.id)) {
              <div class="animate-fade-in-up">
                <!-- Achievements -->
                <div class="mb-3 sm:mb-4">
                  <h4 class="text-xs sm:text-sm font-semibold text-gray-300 mb-2 flex items-center gap-2">
                    <svg class="w-3.5 h-3.5 sm:w-4 sm:h-4 text-neon-cyan flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    主要成就
                  </h4>
                  <ul class="space-y-1.5 sm:space-y-2 text-left">
                    @for (achievement of exp.achievements; track achievement) {
                      <li class="text-gray-400 text-xs sm:text-sm flex items-start gap-2">
                        <span class="text-neon-pink mt-0.5 sm:mt-1 flex-shrink-0">▸</span>
                        <span>{{ achievement }}</span>
                      </li>
                    }
                  </ul>
                </div>

                <!-- Technologies -->
                <div class="flex flex-wrap gap-1.5 sm:gap-2">
                  @for (tech of exp.technologies; track tech) {
                    <span class="px-2 py-0.5 sm:px-3 sm:py-1 text-[10px] sm:text-xs rounded-full bg-deep-purple/50 text-gray-300 border border-neon-cyan/20">
                      {{ tech }}
                    </span>
                  }
                </div>
              </div>
            }

            <!-- Expand Indicator -->
            <div class="flex items-center gap-1 mt-3 sm:mt-4 text-gray-500 text-xs sm:text-sm">
              <span>{{ isExpanded(exp.id) ? '收起' : '展開詳情' }}</span>
              <svg
                class="w-3.5 h-3.5 sm:w-4 sm:h-4 transition-transform duration-300 flex-shrink-0"
                [class.rotate-180]="isExpanded(exp.id)"
                fill="none" stroke="currentColor" viewBox="0 0 24 24"
              >
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </div>
          </div>
        </div>
      }
    </div>
  </div>

  <!-- Background Decoration -->
  <div class="absolute top-1/3 left-0 w-48 sm:w-72 md:w-96 h-48 sm:h-72 md:h-96 bg-deep-purple/10 rounded-full blur-3xl pointer-events-none"></div>
  <div class="absolute bottom-1/3 right-0 w-40 sm:w-56 md:w-72 h-40 sm:h-56 md:h-72 bg-neon-cyan/5 rounded-full blur-3xl pointer-events-none"></div>
</section>
